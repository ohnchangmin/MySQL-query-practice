
-- 직원IDX가 5번인 아르바이트생의 한달(21년 10월 1일부터 21년 10월 31일까지)의 급여를 조회하는 쿼리

SELECT SUM(E.EMP.SALARY * (SELECT A.ATTENDANCE_END - A.ATTENDANCE_START FROM ATTENDANCE AS A, EMPLOYEE AS E WHERE E.EMP_IDX = 5 AND A.WORKDATE BETWEEN '2021-10-01' AND '2021-10-31')) 
FROM EMPLOYEE AS E
WHERE E.EMP.IDX = 5;

-- 커피원두의 재고와 입고 내역 조회
SELECT * FROM STOCK AS S
JOIN WAREHOUSING_HISTORY AS W
ON S.STOCK_NAME = W.STOCK_NAME

-- 멤버쉽 IDX가 1번인 멤버쉽 회원의 적립금 내역 조회
SELECT P.POINT_STATUS, P.POINT_AMOUNT, P.POINT_COMMENT, P.POINT_USE_STORE, P.POINT_DATE 
FROM POINT AS P
WHERE P.MEM_IDX = 1


-- 최근한달동안 구매수량이 많은 인기순으로 정렬하여 메뉴를 조회
-- 현재 오류남(JOIN 위치)
SELECT MENU_IDX, SUM(ORDER_NUM) 
FROM ORDER_T
WHERE ORDER_DATE BETWEEN DATE_ADD(NOW(), INTERVAL -1 MONTH ) AND NOW()
JOIN MENU
ON MENU.MENU_IDX = ORDER_T.MENU_IDX
GROUP BY MENU_IDX 
ORDER BY SUM(ORDER_NUM) DESC;

-- 수정...
SELECT * FROM MENU
RIGHT JOIN
(SELECT MENU_IDX, SUM(ORDER_NUM) 
FROM ORDER_T
WHERE ORDER_DATE BETWEEN DATE_ADD(NOW(), INTERVAL -1 MONTH ) AND NOW()
GROUP BY MENU_IDX 
ORDER BY SUM(ORDER_NUM) DESC) AS HOT_MENU
ON MENU.MENU_IDX = HOT_MENU.MENU_IDX;
